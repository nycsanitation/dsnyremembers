const labelLayer=L.tileLayer("https://maps.nyc.gov/xyz/1.0.0/carto/label-lt/{z}/{x}/{y}.png8",{minNativeZoom:8,maxNativeZoom:19,subdomains:"1234",bounds:L.latLngBounds([40.0341,-74.2727],[41.2919,-71.9101])}),mbLight=new L.tileLayer(mapboxAPI,{id:"mapbox/light-v10",tileSize:512,maxZoom:18,zoomOffset:-1,accessToken:accessToken}),mbSatellite=new L.tileLayer(mapboxAPI,{id:"mapbox/satellite-v9",tileSize:512,maxZoom:18,zoomOffset:-1,accessToken:accessToken}),ortho2001=new L.tileLayer("https://maps.nyc.gov/xyz/1.0.0/photo/2001-2/{z}/{x}/{y}.png8",{minNativeZoom:8,maxNativeZoom:19,subdomains:"1234",bounds:L.latLngBounds([40.4888,-74.2759],[40.9279,-73.6896])}),aerialGroup=new L.layerGroup([ortho2001,labelLayer]),cleanup1=new L.geoJSON(null,{style:myStyle.cleanup1,onEachFeature:onEachSector}),cleanup2=new L.geoJSON(null,{style:myStyle.cleanup2,onEachFeature:onEachSector}),debrisPorts=new L.geoJSON(null,{pointToLayer:(feature,latlng)=>L.marker(latlng,{icon:portIcon}),onEachFeature:onEachPort}),bargeRoutes=new L.geoJSON(null,{style:myStyle.bargeRoutes,onEachFeature:onEachBargeRoute}),truckRoutes=new L.geoJSON(null,{style:myStyle.truckRoutes,onEachFeature:onEachTruckRoute}),buildingDamage=new L.geoJSON(null,{style:myStyle.buildings,onEachFeature:onEachBuilding}),freshKills=new L.geoJSON(null,{style:myStyle.freshKills,onEachFeature:onEachArea}),videoLinks=new L.geoJSON(null,{pointToLayer:(feature,latlng)=>L.marker(latlng,{icon:videoIcon}),onEachFeature:onEachVideo}),polygonLayerGroup=new L.layerGroup([cleanup1,cleanup2,buildingDamage]),shownLayers=new L.layerGroup([debrisPorts,bargeRoutes,cleanup1,videoLinks]),myMap=new L.map("mapid",{center:[40.707,-74.007],zoom:15,layers:[mbLight,shownLayers],attributionControl:!1,doubleClickZoom:!1,maxBounds:L.latLngBounds(L.latLng(40.33,-74.7),L.latLng(41.08,-73.2)),minZoom:10,maxZoom:18,tap:!1}),credits=L.control.attribution({prefix:!1}).addTo(myMap),mapboxURL="https://www.mapbox.com/about/maps/";credits.addAttribution(`Â© <a href="${mapboxURL}" target="_blank">Mapbox</a>`);const legend=new L.control({position:"bottomleft"});legend.onAdd=()=>{let classes,colorFunc,title;const div=new L.DomUtil.create("div","info legend unselectable");classes=["No Damage","Moderate Damage","Major Damage","Partial Collapse","Destroyed"],colorFunc=myStyle.getBuildingColor,title='<h6 class="font-weight-bold">Building Damage</h6>';let html=[title],labels=[];for(let i=0;i<classes.length;i++)labels.push(`&ensp;<svg style="background: ${colorFunc(classes[i])}; opacity: 0.6; border: 1px solid black; width: 1.3em; height: 1.3em"></svg>&ensp;${classes[i]}`);return html.push(labels.join("<br>")),div.innerHTML=html.join(""),div};const groupedOverlays={"DSNY Cleanup Zones":{"Phase 1":cleanup1,"Phase 2":cleanup2},"Debris Field":{"Building Damage":buildingDamage,"Fresh Kills Burial Site":freshKills},"WTC Debris Transport":{Ports:debrisPorts,"Truck Routes":truckRoutes,"Barge Routes":bargeRoutes},Other:{Videos:videoLinks}},baseMaps={Grayscale:mbLight,Satellite:mbSatellite,"Ortho 2001":aerialGroup},layerControls=new L.control.groupedLayers(baseMaps,groupedOverlays).addTo(myMap),gitURL="https://raw.githubusercontent.com/nycsanitation/dsnyremembers/main/layers/";$.getJSON(`${gitURL}cleanup_zones1.geojson`,data=>{cleanup1.addData(data)}),$.getJSON(`${gitURL}cleanup_zones2.geojson`,data=>{cleanup2.addData(data)}),$.getJSON(`${gitURL}debris_ports.geojson`,data=>{debrisPorts.addData(data)}),$.getJSON(`${gitURL}barge_routes.geojson`,data=>{bargeRoutes.addData(data)}),$.getJSON(`${gitURL}truck_routes.geojson`,data=>{truckRoutes.addData(data)}),$.getJSON(`${gitURL}building_damage.geojson`,data=>{buildingDamage.addData(data)}),$.getJSON(`${gitURL}fresh_kills.geojson`,data=>{freshKills.addData(data)}),$.getJSON(`${gitURL}videos.geojson`,data=>{videoLinks.addData(data)}),myMap.on({baselayerchange:base=>{shownLayers.addLayer(base.layer).addLayer(labelLayer),"Ortho 2001"!==base.name&&shownLayers.removeLayer(labelLayer)},overlayadd:overlay=>{const zoom=myMap.getZoom();polygonLayerGroup.eachLayer(layer=>{layer.resetStyle(),zoom>14&&layer.eachLayer(feature=>{const center=feature.getBounds().getCenter();feature.openTooltip(center)}),zoom<=14&&layer.eachLayer(feature=>{feature.closeTooltip()})}),shownLayers.addLayer(overlay.layer),"Building Damage"==overlay.name&&legend.addTo(myMap)},overlayremove:overlay=>{shownLayers.removeLayer(overlay.layer),"Building Damage"==overlay.name&&myMap.removeControl(legend)},zoomend:()=>{const zoom=myMap.getZoom();polygonLayerGroup.eachLayer(layer=>{zoom>14&&layer.eachLayer(feature=>{const center=feature.getBounds().getCenter();feature.openTooltip(center)}),zoom<=14&&layer.eachLayer(feature=>{feature.closeTooltip()})})}}),$(document).ready(()=>{$("#header button").click(e=>{let bounds;const id=$(e.target).attr("id"),options={padding:[-10,-10],duration:.2};shownLayers.clearLayers(),"btn-cz"==id?(bounds=cleanup2.getBounds(),shownLayers.addLayer(mbLight).addLayer(cleanup2).addLayer(debrisPorts)):"btn-df"==id?(bounds=buildingDamage.getBounds(),shownLayers.addLayer(aerialGroup).addLayer(buildingDamage)):"btn-dt"==id?(bounds=truckRoutes.getBounds(),shownLayers.addLayer(mbLight).addLayer(debrisPorts).addLayer(bargeRoutes).addLayer(truckRoutes)):"btn-fk"==id&&(bounds=freshKills.getBounds(),shownLayers.addLayer(mbSatellite).addLayer(freshKills).addLayer(debrisPorts)),myMap.flyToBounds(bounds,options),"btn-dt"!=id&&shownLayers.addLayer(videoLinks),shownLayers.addTo(myMap)}),myMap.flyToBounds(cleanup1.getBounds())});